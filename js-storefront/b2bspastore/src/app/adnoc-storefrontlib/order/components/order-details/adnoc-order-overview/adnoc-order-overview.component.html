<div class="cx-order-summary" *ngIf="order$ | async as order">
  <ng-container *ngIf="!(isOrderLoading$ | async)">
    <ng-container *ngIf="!(simple$ | async)">
      <ng-container *ngIf="order.replenishmentOrderCode; else otherOrderData">
        <div class="container">
          <ng-container>
            <div class="cx-summary-card">
              <cx-card
                [content]="
                  getReplenishmentCodeCardContent(order?.replenishmentOrderCode)
                    | async
                "
              ></cx-card>

              <cx-card
                [content]="
                  getReplenishmentActiveCardContent(order?.active) | async
                "
              ></cx-card>
            </div>

            <div class="cx-summary-card">
              <cx-card
                [content]="
                  getReplenishmentStartOnCardContent(order?.firstDate | cxDate)
                    | async
                "
              ></cx-card>

              <cx-card
                [content]="
                  getReplenishmentFrequencyCardContent(
                    order?.trigger?.displayTimeTable
                  ) | async
                "
              ></cx-card>

              <cx-card
                [content]="
                  getReplenishmentNextDateCardContent(
                    order?.trigger?.activationTime | cxDate
                  ) | async
                "
              ></cx-card>

              <ng-template
                [cxOutlet]="cartOutlets.ORDER_OVERVIEW"
                [cxOutletContext]="{ item: order, readonly: true }"
              >
              </ng-template>
            </div>
          </ng-container>

          <ng-template #otherOrder>
            <div class="cx-summary-card">
              <cx-card
                [content]="getOrderCodeCardContent(order?.code) | async"
              ></cx-card>

              <cx-card
                [content]="
                  getOrderCurrentDateCardContent(order?.created | cxDate)
                    | async
                "
              ></cx-card>

              <cx-card
                [content]="
                  getOrderStatusCardContent(order.statusDisplay) | async
                "
              ></cx-card>

              <ng-template
                [cxOutlet]="cartOutlets.ORDER_OVERVIEW"
                [cxOutletContext]="{ item: order, readonly: true }"
              >
              </ng-template>
            </div>
          </ng-template>

          <ng-container
            *ngIf="
              order.purchaseOrderNumber || order.purchaseOrderNumber === ''
            "
          >
            <div class="cx-summary-card 123">
              <cx-card
                [content]="
                  getPurchaseOrderNumber(order?.purchaseOrderNumber) | async
                "
              ></cx-card>

              <cx-card
                [content]="
                  getMethodOfPaymentCardContent(order.paymentInfo) | async
                "
              ></cx-card>

              <ng-container *ngIf="order.costCenter">
                <cx-card
                  [content]="
                    getCostCenterCardContent(order?.costCenter) | async
                  "
                ></cx-card>
              </ng-container>
            </div>
          </ng-container>

          <div class="cx-summary-card">
            <ng-container *ngIf="order.deliveryAddress">
              <cx-card
                [content]="
                  getAddressCardContent(order?.deliveryAddress) | async
                "
              ></cx-card>
            </ng-container>

            <ng-container *ngIf="shouldShowDeliveryMode(order.deliveryMode)">
              <cx-card
                [content]="
                  getDeliveryModeCardContent(order?.deliveryMode) | async
                "
              ></cx-card>
            </ng-container>

            <ng-template
              [cxOutlet]="orderOutlets.SERVICE_DETAILS"
              [cxOutletContext]="{ item: order, readonly: true }"
            >
            </ng-template>
          </div>

          <ng-container *ngIf="order.paymentInfo">
            <div
              class="cx-summary-card"
              *ngIf="
                order?.paymentInfo?.billingAddress ||
                isPaymentInfoCardFull(order?.paymentInfo)
              "
            >
              <ng-container *ngIf="isPaymentInfoCardFull(order?.paymentInfo)">
                <cx-card
                  [content]="
                    getPaymentInfoCardContent(order?.paymentInfo) | async
                  "
                ></cx-card>
              </ng-container>

              <cx-card
                [content]="
                  getBillingAddressCardContent(
                    order?.paymentInfo?.billingAddress
                  ) | async
                "
              ></cx-card>
            </div>
          </ng-container>
        </div>
      </ng-container>
    </ng-container>

    <div *ngIf="simple$ | async" class="container">
      <div class="cx-order-details-cards">
        <cx-card
          [content]="getOrderCodeCardContent(order?.code) | async"
        ></cx-card>

        <cx-card
          [content]="
            getOrderCurrentDateCardContent(order?.created | cxDate) | async
          "
        ></cx-card>

        <cx-card
          [content]="getOrderStatusCardContent(order.statusDisplay) | async"
        ></cx-card>

        <ng-template
          [cxOutlet]="cartOutlets.ORDER_OVERVIEW"
          [cxOutletContext]="{ item: order, readonly: true }"
        >
        </ng-template>
      </div>
      <cx-order-detail-billing
        *ngIf="
          isPaymentInfoCardFull(order?.paymentInfo) ||
          order?.paymentInfo?.billingAddress
        "
      ></cx-order-detail-billing>
    </div>
  </ng-container>

  <ng-template #otherOrderData>
    <div class="order-details-container">
      <ng-container>
        <div class="order-row">
          <div class="order-info shipTo">
            <p class="orderData">
              {{ "userOrderTranslations.order.shipTo" | cxTranslate }}
            </p>
            <p>{{ order.deliveryAddress?.sapCustomerID }}</p>
            <p class="orderShipTo">{{ order.deliveryAddress?.companyName }},</p>
            <p class="orderShipTo">{{ order.deliveryAddress?.line1 }},</p>
            <p class="orderShipTo">{{ order.deliveryAddress?.town }},</p>
            <p class="orderShipTo">
              {{ order.deliveryAddress?.region?.name }},
            </p>
            <p class="orderShipTo">
              {{ order.deliveryAddress?.country?.name }}
            </p>
          </div>
          <div class="orderStatus rightAlign">
            <p class="orderData">
              {{ "userOrderTranslations.order.orderStatus" | cxTranslate }}
              <span class="{{ order.status }}">{{ order.statusDisplay }}</span>
            </p>
            <p *ngIf="order?.orgUnit?.uid" class="orderData">
              {{ "userOrderTranslations.order.payerId" | cxTranslate }}
              <span class="subValueFonts">{{ order.orgUnit.uid }}</span>
            </p>
            <p *ngIf="order?.orgUnit?.name" class="orderData">
              {{ "userOrderTranslations.order.payerName" | cxTranslate }}
              <span class="subValueFonts">{{ order.orgUnit.name }}</span>
            </p>
          </div>
        </div>
        <div class="order-row">
          <div class="order-info orderNumCreated">
            <p>
              {{ "userOrderTranslations.order.sapOrderNumber" | cxTranslate }}
              <span *ngIf="order?.sapOrderCode" class="headValueFonts">{{
                order.sapOrderCode
              }}</span>
            </p>
            <div class="order-details-subrow">
              <p class="orderNumber">
                {{ "userOrderTranslations.order.orderNumber" | cxTranslate }}
                <span class="subValueFonts">{{ order.code }}</span>
              </p>
            </div>
            <div class="order-details-subrow">
              <span class="createdDate">
                <i class="fa-regular fa-clock"></i>
                {{
                  "userOrderTranslations.order.orderPlacedDateAndTime"
                    | cxTranslate
                }}
                {{ order.created | cxDate : "medium" }}
              </span>
            </div>
          </div>
          <div class="order-info rightAlign orderNumCreated">
            <p>
              {{
                "userOrderTranslations.order.purchaseOrderNumber" | cxTranslate
              }}
              <span class="headValueFonts">{{
                order.purchaseOrderNumber ? order.purchaseOrderNumber : "None"
              }}</span>
            </p>
            <div
              class="methodOfPayment"
              *ngIf="paymentMethodCardContent$ | async as paymentMethodCard"
            >
              <div
                class="order-details-subrow rightAlign"
                *ngIf="paymentMethodCard.text.length > 0"
              >
                <p class="method createdDate">
                  <i class="fa fa-wallet"></i>
                  {{
                    "userOrderTranslations.order.paymentMethod" | cxTranslate
                  }}
                  {{ paymentMethodCard?.text[0] }}
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="order-row">
          <div class="order-info deliveryType">
            <p *ngIf="order.shippingCondition?.name">
              {{ "userOrderTranslations.order.deliveryType" | cxTranslate }}
              <span class="headValueFonts">{{
                order.shippingCondition?.name
              }}</span>
            </p>
          </div>
          <div class="orderStatus rightAlign orderNumCreated">
            <ng-container
              *ngIf="
                order?.paymentTransactions?.length > 0;
                else noTransactions
              "
            >
              <ng-container
                *ngFor="
                  let transaction of order.paymentTransactions;
                  let i = index
                "
              >
                <ng-container *ngIf="transaction?.paymentInfo?.cardNumber">
                  <p class="orderData">
                    {{ "userOrderTranslations.order.cardNumber" | cxTranslate }}
                    <span class="subValueFonts">{{
                      order?.paymentInfo.cardNumber
                    }}</span>
                  </p>

                  <p class="orderData" *ngIf="transaction?.rrnNumber">
                    {{
                      "userOrderTranslations.order.transactionReference"
                        | cxTranslate
                    }}
                    <span class="subValueFonts">{{
                      transaction?.rrnNumber
                    }}</span>
                  </p>

                  <p class="orderData" *ngIf="transaction?.plannedAmount">
                    {{ "userOrderTranslations.order.cardAmount" | cxTranslate }}
                    <span class="subValueFonts"
                      >{{ order?.totalPrice.currencyIso
                      }}{{
                        transaction?.plannedAmount | number : "1.2-2"
                      }}</span
                    >
                  </p>
                </ng-container>
                <ng-container *ngIf="transaction?.paymentInfo?.account">
                  <p
                    class="orderData"
                    *ngIf="transaction?.paymentInfo?.approvalCode"
                  >
                    {{
                      "userOrderTranslations.order.referenceNo" | cxTranslate
                    }}
                    <span class="subValueFonts">{{
                      transaction?.paymentInfo?.approvalCode
                    }}</span>
                  </p>
                  <p
                    class="orderData"
                    *ngIf="transaction?.paymentInfo?.transactionId"
                  >
                    {{
                      "userOrderTranslations.order.transactionId" | cxTranslate
                    }}
                    <span class="subValueFonts">{{
                      transaction?.paymentInfo?.transactionId
                    }}</span>
                  </p>
                  <p class="orderData" *ngIf="transaction?.plannedAmount">
                    {{
                      "userOrderTranslations.order.bankTransferAmount"
                        | cxTranslate
                    }}
                    <span class="subValueFonts"
                      >{{ order?.totalPrice.currencyIso
                      }}{{
                        transaction?.plannedAmount | number : "1.2-2"
                      }}</span
                    >
                  </p>
                </ng-container>
                <ng-container
                  *ngIf="
                    !transaction?.paymentInfo?.cardNumber &&
                    !transaction?.paymentInfo?.account
                  "
                >
                  <p class="orderData" *ngIf="transaction?.plannedAmount">
                    {{
                      "userOrderTranslations.order.creditUtilized" | cxTranslate
                    }}
                    <span class="subValueFonts"
                      >{{ order?.totalPrice.currencyIso
                      }}{{
                        transaction?.plannedAmount | number : "1.2-2"
                      }}</span
                    >
                  </p>
                </ng-container>
              </ng-container>
            </ng-container>
            <ng-template #noTransactions>
              <p class="orderData">
                {{ "userOrderTranslations.order.noPaymentInfo" | cxTranslate }}
              </p>
            </ng-template>
          </div>
        </div>
      </ng-container>
    </div>
  </ng-template>
</div>
